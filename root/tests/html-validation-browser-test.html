<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Validation and Browser Compatibility Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-header {
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        .test-section {
            margin-bottom: 32px;
        }
        .test-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .test-item:last-child {
            border-bottom: none;
        }
        .test-status {
            width: 80px;
            font-weight: bold;
            margin-right: 16px;
        }
        .test-pass {
            color: #22c55e;
        }
        .test-fail {
            color: #ef4444;
        }
        .test-pending {
            color: #f59e0b;
        }
        .test-name {
            flex: 1;
            font-weight: 500;
        }
        .test-description {
            color: #666;
            font-size: 14px;
        }
        .run-tests-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
        }
        .run-tests-btn:hover {
            background: #2563eb;
        }
        .results-summary {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 16px;
            margin-top: 20px;
        }
        .browser-info {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 20px;
        }
        .validation-details {
            background: #fefce8;
            border: 1px solid #eab308;
            border-radius: 6px;
            padding: 16px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>HTML Validation and Browser Compatibility Test</h1>
            <p>Testing HTML5 compliance and cross-browser compatibility for all pages.</p>
            <button class="run-tests-btn" onclick="runAllTests()">Run All Tests</button>
        </div>

        <div class="browser-info" id="browser-info">
            <h3>Current Browser Information</h3>
            <div id="browser-details"></div>
        </div>

        <div class="test-section">
            <h3>HTML5 Validation Tests</h3>
            <div id="html-validation-results">
                <div class="test-item">
                    <span class="test-status test-pending" id="status-doctype">PENDING</span>
                    <div>
                        <div class="test-name">DOCTYPE Declaration</div>
                        <div class="test-description">Verify HTML5 DOCTYPE is present and correct</div>
                    </div>
                </div>

                <div class="test-item">
                    <span class="test-status test-pending" id="status-meta">PENDING</span>
                    <div>
                        <div class="test-name">Meta Tags</div>
                        <div class="test-description">Check required meta tags (charset, viewport)</div>
                    </div>
                </div>

                <div class="test-item">
                    <span class="test-status test-pending" id="status-semantic">PENDING</span>
                    <div>
                        <div class="test-name">Semantic HTML5 Elements</div>
                        <div class="test-description">Verify proper use of semantic elements</div>
                    </div>
                </div>

                <div class="test-item">
                    <span class="test-status test-pending" id="status-attributes">PENDING</span>
                    <div>
                        <div class="test-name">HTML Attributes</div>
                        <div class="test-description">Check for proper attribute usage and values</div>
                    </div>
                </div>

                <div class="test-item">
                    <span class="test-status test-pending" id="status-structure">PENDING</span>
                    <div>
                        <div class="test-name">Document Structure</div>
                        <div class="test-description">Validate proper HTML document structure</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>Browser Compatibility Tests</h3>
            <div id="browser-compatibility-results">
                <div class="test-item">
                    <span class="test-status test-pending" id="status-css-support">PENDING</span>
                    <div>
                        <div class="test-name">CSS Features Support</div>
                        <div class="test-description">Test modern CSS features (Grid, Flexbox, Custom Properties)</div>
                    </div>
                </div>

                <div class="test-item">
                    <span class="test-status test-pending" id="status-js-support">PENDING</span>
                    <div>
                        <div class="test-name">JavaScript Features Support</div>
                        <div class="test-description">Test ES6+ features and DOM APIs</div>
                    </div>
                </div>

                <div class="test-item">
                    <span class="test-status test-pending" id="status-html5-support">PENDING</span>
                    <div>
                        <div class="test-name">HTML5 Features Support</div>
                        <div class="test-description">Test HTML5 form validation, semantic elements</div>
                    </div>
                </div>

                <div class="test-item">
                    <span class="test-status test-pending" id="status-progressive">PENDING</span>
                    <div>
                        <div class="test-name">Progressive Enhancement</div>
                        <div class="test-description">Verify graceful degradation for unsupported features</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="results-summary" id="results-summary" style="display: none;">
            <h3>Test Results Summary</h3>
            <div id="summary-content"></div>
        </div>
    </div>

    <script>
        let testResults = {};
        let totalTests = 9;

        function detectBrowser() {
            const userAgent = navigator.userAgent;
            const browserInfo = {
                name: 'Unknown',
                version: 'Unknown',
                engine: 'Unknown'
            };

            if (userAgent.includes('Chrome') && !userAgent.includes('Edg')) {
                browserInfo.name = 'Chrome';
                browserInfo.version = userAgent.match(/Chrome\/([0-9.]+)/)?.[1] || 'Unknown';
                browserInfo.engine = 'Blink';
            } else if (userAgent.includes('Firefox')) {
                browserInfo.name = 'Firefox';
                browserInfo.version = userAgent.match(/Firefox\/([0-9.]+)/)?.[1] || 'Unknown';
                browserInfo.engine = 'Gecko';
            } else if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) {
                browserInfo.name = 'Safari';
                browserInfo.version = userAgent.match(/Version\/([0-9.]+)/)?.[1] || 'Unknown';
                browserInfo.engine = 'WebKit';
            } else if (userAgent.includes('Edg')) {
                browserInfo.name = 'Edge';
                browserInfo.version = userAgent.match(/Edg\/([0-9.]+)/)?.[1] || 'Unknown';
                browserInfo.engine = 'Blink';
            }

            return browserInfo;
        }

        function displayBrowserInfo() {
            const browser = detectBrowser();
            const browserDetails = document.getElementById('browser-details');
            
            browserDetails.innerHTML = `
                <p><strong>Browser:</strong> ${browser.name} ${browser.version}</p>
                <p><strong>Engine:</strong> ${browser.engine}</p>
                <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
                <p><strong>Platform:</strong> ${navigator.platform}</p>
                <p><strong>Language:</strong> ${navigator.language}</p>
            `;
        }

        async function runAllTests() {
            console.log('Starting HTML validation and browser compatibility tests...');
            
            // Reset all tests to pending
            document.querySelectorAll('.test-status').forEach(status => {
                status.className = 'test-status test-pending';
                status.textContent = 'RUNNING';
            });

            // Display browser info
            displayBrowserInfo();

            // Run HTML validation tests
            await testDoctypeDeclaration();
            await testMetaTags();
            await testSemanticElements();
            await testHTMLAttributes();
            await testDocumentStructure();

            // Run browser compatibility tests
            await testCSSSupport();
            await testJavaScriptSupport();
            await testHTML5Support();
            await testProgressiveEnhancement();

            // Show results
            showResultsSummary();
        }

        async function testDoctypeDeclaration() {
            const testId = 'doctype';
            try {
                const doctype = document.doctype;
                const hasHTML5Doctype = doctype && 
                    doctype.name.toLowerCase() === 'html' && 
                    !doctype.publicId && 
                    !doctype.systemId;

                updateTestStatus(testId, hasHTML5Doctype, 
                    hasHTML5Doctype ? 'HTML5 DOCTYPE found' : 'Invalid or missing DOCTYPE');
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        async function testMetaTags() {
            const testId = 'meta';
            try {
                const charsetMeta = document.querySelector('meta[charset]');
                const viewportMeta = document.querySelector('meta[name="viewport"]');
                
                const hasCharset = charsetMeta && charsetMeta.getAttribute('charset').toLowerCase() === 'utf-8';
                const hasViewport = viewportMeta && viewportMeta.content.includes('width=device-width');

                const success = hasCharset && hasViewport;
                updateTestStatus(testId, success, 
                    success ? 'Required meta tags present' : 'Missing required meta tags');
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        async function testSemanticElements() {
            const testId = 'semantic';
            try {
                // Test for semantic HTML5 elements
                const semanticElements = ['header', 'nav', 'main', 'section', 'article', 'aside', 'footer'];
                const testDoc = document.createElement('div');
                testDoc.innerHTML = `
                    <header><nav></nav></header>
                    <main>
                        <section>
                            <article></article>
                        </section>
                        <aside></aside>
                    </main>
                    <footer></footer>
                `;

                let supportedElements = 0;
                semanticElements.forEach(tagName => {
                    const element = document.createElement(tagName);
                    if (element.toString() !== '[object HTMLUnknownElement]') {
                        supportedElements++;
                    }
                });

                const success = supportedElements === semanticElements.length;
                updateTestStatus(testId, success, 
                    `${supportedElements}/${semanticElements.length} semantic elements supported`);
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        async function testHTMLAttributes() {
            const testId = 'attributes';
            try {
                // Test HTML5 attributes
                const testInput = document.createElement('input');
                testInput.type = 'email';
                testInput.required = true;
                testInput.placeholder = 'test';

                const supportsEmailType = testInput.type === 'email';
                const supportsRequired = testInput.hasAttribute('required');
                const supportsPlaceholder = testInput.hasAttribute('placeholder');

                const success = supportsEmailType && supportsRequired && supportsPlaceholder;
                updateTestStatus(testId, success, 
                    success ? 'HTML5 attributes supported' : 'Some HTML5 attributes not supported');
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        async function testDocumentStructure() {
            const testId = 'structure';
            try {
                const hasHtml = document.documentElement.tagName.toLowerCase() === 'html';
                const hasHead = document.head !== null;
                const hasBody = document.body !== null;
                const hasTitle = document.title && document.title.length > 0;

                const success = hasHtml && hasHead && hasBody && hasTitle;
                updateTestStatus(testId, success, 
                    success ? 'Document structure valid' : 'Document structure issues');
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        async function testCSSSupport() {
            const testId = 'css-support';
            try {
                const testElement = document.createElement('div');
                document.body.appendChild(testElement);

                // Test CSS Grid
                testElement.style.display = 'grid';
                const supportsGrid = getComputedStyle(testElement).display === 'grid';

                // Test CSS Flexbox
                testElement.style.display = 'flex';
                const supportsFlex = getComputedStyle(testElement).display === 'flex';

                // Test CSS Custom Properties
                testElement.style.setProperty('--test-var', 'red');
                testElement.style.color = 'var(--test-var)';
                const supportsCustomProps = getComputedStyle(testElement).color === 'red';

                document.body.removeChild(testElement);

                const supportedFeatures = [supportsGrid, supportsFlex, supportsCustomProps].filter(Boolean).length;
                const success = supportedFeatures >= 2;

                updateTestStatus(testId, success, 
                    `${supportedFeatures}/3 CSS features supported (Grid: ${supportsGrid}, Flex: ${supportsFlex}, Custom Props: ${supportsCustomProps})`);
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        async function testJavaScriptSupport() {
            const testId = 'js-support';
            try {
                // Test ES6 features
                const supportsArrowFunctions = (() => true)();
                const supportsConst = (() => { try { eval('const x = 1'); return true; } catch { return false; } })();
                const supportsPromises = typeof Promise !== 'undefined';
                const supportsFetch = typeof fetch !== 'undefined';

                const supportedFeatures = [supportsArrowFunctions, supportsConst, supportsPromises, supportsFetch].filter(Boolean).length;
                const success = supportedFeatures >= 3;

                updateTestStatus(testId, success, 
                    `${supportedFeatures}/4 JS features supported`);
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        async function testHTML5Support() {
            const testId = 'html5-support';
            try {
                // Test HTML5 form validation
                const testForm = document.createElement('form');
                const testInput = document.createElement('input');
                testInput.type = 'email';
                testInput.required = true;
                testForm.appendChild(testInput);

                const supportsValidation = typeof testInput.checkValidity === 'function';
                const supportsFormData = typeof FormData !== 'undefined';
                const supportsLocalStorage = typeof localStorage !== 'undefined';

                const supportedFeatures = [supportsValidation, supportsFormData, supportsLocalStorage].filter(Boolean).length;
                const success = supportedFeatures >= 2;

                updateTestStatus(testId, success, 
                    `${supportedFeatures}/3 HTML5 features supported`);
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        async function testProgressiveEnhancement() {
            const testId = 'progressive';
            try {
                // Test that basic functionality works without advanced features
                const testDiv = document.createElement('div');
                testDiv.textContent = 'Test content';
                
                // Test basic DOM manipulation
                const canCreateElements = testDiv.tagName === 'DIV';
                const canSetContent = testDiv.textContent === 'Test content';
                
                // Test CSS fallbacks
                testDiv.style.backgroundColor = 'red';
                testDiv.style.backgroundColor = 'var(--nonexistent-var, blue)';
                const hasFallback = getComputedStyle(testDiv).backgroundColor !== '';

                const success = canCreateElements && canSetContent && hasFallback;
                updateTestStatus(testId, success, 
                    success ? 'Progressive enhancement working' : 'Progressive enhancement issues');
            } catch (error) {
                updateTestStatus(testId, false, `Error: ${error.message}`);
            }
        }

        function updateTestStatus(testId, passed, message) {
            const statusElement = document.getElementById(`status-${testId}`);
            if (statusElement) {
                statusElement.className = `test-status ${passed ? 'test-pass' : 'test-fail'}`;
                statusElement.textContent = passed ? 'PASS' : 'FAIL';
            }
            
            testResults[testId] = { passed, message };
            console.log(`Test ${testId}: ${passed ? 'PASS' : 'FAIL'} - ${message}`);
        }

        function showResultsSummary() {
            const summaryContainer = document.getElementById('results-summary');
            const summaryContent = document.getElementById('summary-content');
            
            const passedTests = Object.values(testResults).filter(result => result.passed).length;
            const failedTests = totalTests - passedTests;
            const successRate = Math.round((passedTests / totalTests) * 100);
            
            const browser = detectBrowser();
            
            summaryContent.innerHTML = `
                <p><strong>Browser:</strong> ${browser.name} ${browser.version}</p>
                <p><strong>Total Tests:</strong> ${totalTests}</p>
                <p><strong>Passed:</strong> ${passedTests}</p>
                <p><strong>Failed:</strong> ${failedTests}</p>
                <p><strong>Success Rate:</strong> ${successRate}%</p>
                ${successRate >= 90 ? 
                    '<p style="color: #22c55e; font-weight: bold;">✅ Excellent browser compatibility!</p>' : 
                    successRate >= 75 ?
                    '<p style="color: #f59e0b; font-weight: bold;">⚠️ Good compatibility with minor issues.</p>' :
                    '<p style="color: #ef4444; font-weight: bold;">❌ Significant compatibility issues detected.</p>'
                }
                <div class="validation-details">
                    <strong>Detailed Results:</strong><br>
                    ${Object.entries(testResults).map(([test, result]) => 
                        `${test}: ${result.passed ? 'PASS' : 'FAIL'} - ${result.message}`
                    ).join('<br>')}
                </div>
            `;
            
            summaryContainer.style.display = 'block';
        }

        // Auto-run tests when page loads
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('Auto-running HTML validation and browser compatibility tests...');
                runAllTests();
            }, 1000);
        });
    </script>
</body>
</html>