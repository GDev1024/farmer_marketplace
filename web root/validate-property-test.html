<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Test Validation</title>
    <link rel="stylesheet" href="assets/style.css">
    <style>
        body {
            font-family: var(--font-body);
            max-width: 800px;
            margin: 0 auto;
            padding: var(--space-8);
            background-color: var(--color-background);
        }
        .test-result {
            padding: var(--space-4);
            margin: var(--space-2) 0;
            border-radius: var(--radius-md);
            border-left: 4px solid;
        }
        .pass {
            background-color: var(--color-success-bg);
            color: var(--color-success);
            border-left-color: var(--color-success);
        }
        .fail {
            background-color: var(--color-error-bg);
            color: var(--color-error);
            border-left-color: var(--color-error);
        }
        .info {
            background-color: var(--color-info-bg);
            color: var(--color-info);
            border-left-color: var(--color-info);
        }
        .color-sample {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: var(--radius-sm);
            margin-right: var(--space-2);
            border: 1px solid var(--color-border);
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <h1>Natural Color Palette Compliance - Property Test Validation</h1>
    <p><strong>Property 1:</strong> Natural Color Palette Compliance</p>
    <p><strong>Validates:</strong> Requirements 2.2, 3.1, 3.2, 3.3, 3.4</p>
    
    <div id="results"></div>
    
    <script>
        // Quick validation of key design system colors
        const testColors = [
            { name: 'clay-50', value: '#faf9f7' },
            { name: 'clay-500', value: '#a89688' },
            { name: 'clay-900', value: '#4a3f36' },
            { name: 'cream-50', value: '#fefdfb' },
            { name: 'cream-500', value: '#e8d5a6' },
            { name: 'olive-500', value: '#8d9869' },
            { name: 'slate-500', value: '#9aa0a6' },
            { name: 'success', value: '#2d5a27' },
            { name: 'warning', value: '#8b5a00' },
            { name: 'error', value: '#8b2635' }
        ];
        
        function hexToHsl(hex) {
            const r = parseInt(hex.slice(1, 3), 16) / 255;
            const g = parseInt(hex.slice(3, 5), 16) / 255;
            const b = parseInt(hex.slice(5, 7), 16) / 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            
            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            
            return {
                h: Math.round(h * 360),
                s: Math.round(s * 100),
                l: Math.round(l * 100)
            };
        }
        
        function validateColor(colorData) {
            const { name, value } = colorData;
            const hsl = hexToHsl(value);
            
            // Test 1: No pure white
            const noPureWhite = value.toLowerCase() !== '#ffffff' && value.toLowerCase() !== '#fff';
            
            // Test 2: No high saturation (>70%)
            const noHighSaturation = hsl.s <= 70;
            
            // Test 3: No neon colors (high sat + high lightness)
            const noNeonColors = !(hsl.s > 80 && hsl.l > 70);
            
            // Test 4: Within natural ranges or special cases
            const withinNaturalRange = 
                // Clay range
                (hsl.h >= 10 && hsl.h <= 45 && hsl.s <= 50) ||
                // Cream range  
                (hsl.h >= 30 && hsl.h <= 60 && hsl.s <= 40 && hsl.l >= 60) ||
                // Olive range
                (hsl.h >= 60 && hsl.h <= 120 && hsl.s <= 50) ||
                // Slate range
                (hsl.h >= 180 && hsl.h <= 240 && hsl.s <= 25) ||
                // Neutral grays
                (hsl.s <= 15) ||
                // Light neutrals
                (hsl.l >= 90 && hsl.s <= 25) ||
                // Earth tones
                (hsl.h >= 0 && hsl.h <= 60 && hsl.s <= 50 && hsl.l >= 15 && hsl.l <= 85);
            
            const allPassed = noPureWhite && noHighSaturation && noNeonColors && withinNaturalRange;
            
            return {
                name,
                value,
                hsl,
                tests: {
                    noPureWhite,
                    noHighSaturation,
                    noNeonColors,
                    withinNaturalRange
                },
                passed: allPassed
            };
        }
        
        // Run validation
        const results = testColors.map(validateColor);
        const passed = results.filter(r => r.passed).length;
        const total = results.length;
        
        let html = `<div class="test-result info">
            <strong>Property Test Validation Results</strong><br>
            Tested ${total} key colors from design system<br>
            Passed: ${passed}/${total} (${Math.round((passed/total)*100)}%)
        </div>`;
        
        if (passed === total) {
            html += `<div class="test-result pass">
                <strong>✅ PROPERTY TEST VALIDATION PASSED</strong><br>
                All key design system colors comply with natural palette requirements.<br>
                Requirements 2.2, 3.1, 3.2, 3.3, 3.4 are satisfied.
            </div>`;
        } else {
            html += `<div class="test-result fail">
                <strong>❌ PROPERTY TEST VALIDATION FAILED</strong><br>
                Some colors do not comply with requirements.
            </div>`;
        }
        
        // Show individual results
        results.forEach(result => {
            const status = result.passed ? 'pass' : 'fail';
            const icon = result.passed ? '✅' : '❌';
            
            html += `<div class="test-result ${status}">
                <div class="color-sample" style="background-color: ${result.value};"></div>
                <strong>${icon} ${result.name}</strong>: ${result.value}<br>
                HSL: H:${result.hsl.h}°, S:${result.hsl.s}%, L:${result.hsl.l}%<br>
                Tests: Pure White: ${result.tests.noPureWhite ? '✅' : '❌'}, 
                High Sat: ${result.tests.noHighSaturation ? '✅' : '❌'}, 
                Neon: ${result.tests.noNeonColors ? '✅' : '❌'}, 
                Natural: ${result.tests.withinNaturalRange ? '✅' : '❌'}
            </div>`;
        });
        
        document.getElementById('results').innerHTML = html;
    </script>
</body>
</html>