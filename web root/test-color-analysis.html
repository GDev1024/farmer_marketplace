<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Analysis Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .color-test {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .color-sample {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 4px;
            margin-right: 10px;
            vertical-align: middle;
            border: 1px solid #ccc;
        }
        .pass { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Color Palette Analysis</h1>
    <div id="results"></div>

    <script>
        // Test colors from the design system
        const testColors = [
            { name: 'clay-50', value: '#faf9f7' },
            { name: 'clay-500', value: '#a89688' },
            { name: 'clay-900', value: '#4a3f36' },
            { name: 'cream-50', value: '#fefdfb' },
            { name: 'cream-500', value: '#e8d5a6' },
            { name: 'olive-50', value: '#f7f8f4' },
            { name: 'olive-500', value: '#8d9869' },
            { name: 'olive-900', value: '#3c4030' },
            { name: 'slate-50', value: '#f8f9fa' },
            { name: 'slate-500', value: '#9aa0a6' },
            { name: 'slate-900', value: '#202124' },
            { name: 'success', value: '#2d5a27' },
            { name: 'warning', value: '#8b5a00' },
            { name: 'error', value: '#8b2635' }
        ];

        function hexToHsl(hex) {
            const r = parseInt(hex.slice(1, 3), 16) / 255;
            const g = parseInt(hex.slice(3, 5), 16) / 255;
            const b = parseInt(hex.slice(5, 7), 16) / 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            
            if (max === min) {
                h = s = 0; // achromatic
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            
            return {
                h: Math.round(h * 360),
                s: Math.round(s * 100),
                l: Math.round(l * 100)
            };
        }

        function isPureWhite(color) {
            return color.toLowerCase() === '#ffffff' || color.toLowerCase() === '#fff';
        }

        function isHighSaturation(hsl) {
            return hsl.s > 70;
        }

        function isNeonColor(hsl) {
            return hsl.s > 80 && hsl.l > 70;
        }

        function isWithinNaturalRange(hsl) {
            const naturalPalettes = {
                clay: {
                    hueRange: [15, 35],
                    saturationMax: 40,
                    lightnessRange: [20, 95]
                },
                cream: {
                    hueRange: [35, 55],
                    saturationMax: 35,
                    lightnessRange: [70, 98]
                },
                olive: {
                    hueRange: [60, 120],
                    saturationMax: 45,
                    lightnessRange: [25, 90]
                },
                slate: {
                    hueRange: [200, 240],
                    saturationMax: 20,
                    lightnessRange: [15, 95]
                }
            };
            
            for (const [paletteName, palette] of Object.entries(naturalPalettes)) {
                const hueInRange = hsl.h >= palette.hueRange[0] && hsl.h <= palette.hueRange[1];
                const saturationValid = hsl.s <= palette.saturationMax;
                const lightnessInRange = hsl.l >= palette.lightnessRange[0] && hsl.l <= palette.lightnessRange[1];
                
                if (hueInRange && saturationValid && lightnessInRange) {
                    return { valid: true, palette: paletteName };
                }
            }
            
            // Special case for neutral grays (very low saturation)
            if (hsl.s <= 10) {
                return { valid: true, palette: 'neutral' };
            }
            
            return { valid: false, palette: null };
        }

        function analyzeColor(colorData) {
            const hsl = hexToHsl(colorData.value);
            const pureWhiteTest = !isPureWhite(colorData.value);
            const highSaturationTest = !isHighSaturation(hsl);
            const neonTest = !isNeonColor(hsl);
            const naturalRangeResult = isWithinNaturalRange(hsl);
            
            const allPassed = pureWhiteTest && highSaturationTest && neonTest && naturalRangeResult.valid;
            
            return {
                ...colorData,
                hsl,
                tests: {
                    pureWhite: pureWhiteTest,
                    highSaturation: highSaturationTest,
                    neon: neonTest,
                    naturalRange: naturalRangeResult.valid
                },
                palette: naturalRangeResult.palette,
                allPassed
            };
        }

        // Run analysis
        const results = testColors.map(analyzeColor);
        const resultsDiv = document.getElementById('results');
        
        results.forEach(result => {
            const div = document.createElement('div');
            div.className = 'color-test';
            
            const statusClass = result.allPassed ? 'pass' : 'fail';
            const statusText = result.allPassed ? 'PASS' : 'FAIL';
            
            div.innerHTML = `
                <div class="color-sample" style="background-color: ${result.value}"></div>
                <strong>${result.name}</strong> (${result.value}) - <span class="${statusClass}">${statusText}</span>
                <br>
                HSL: H:${result.hsl.h}°, S:${result.hsl.s}%, L:${result.hsl.l}%
                <br>
                Palette: ${result.palette || 'None'}
                <br>
                Tests: Pure White: ${result.tests.pureWhite ? '✓' : '✗'}, 
                High Saturation: ${result.tests.highSaturation ? '✓' : '✗'}, 
                Neon: ${result.tests.neon ? '✓' : '✗'}, 
                Natural Range: ${result.tests.naturalRange ? '✓' : '✗'}
            `;
            
            resultsDiv.appendChild(div);
        });

        // Summary
        const passed = results.filter(r => r.allPassed).length;
        const total = results.length;
        
        const summaryDiv = document.createElement('div');
        summaryDiv.className = 'color-test';
        summaryDiv.innerHTML = `
            <h2>Summary</h2>
            <p><strong>${passed}/${total}</strong> colors passed all tests</p>
            ${passed === total ? '<p class="pass">✓ All colors comply with natural palette requirements!</p>' : '<p class="fail">✗ Some colors need adjustment</p>'}
        `;
        
        resultsDiv.insertBefore(summaryDiv, resultsDiv.firstChild);
    </script>
</body>
</html>